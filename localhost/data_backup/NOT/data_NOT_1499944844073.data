id§NOT_1499944844073°datum§13.07.2017°DatumE§2017-07-13-00-00-00_NOT_1499944844073°quelle§persistent°art§Anleitung°name§Varnish https°info§<p><br></p>°files§°text§<p><br></p><br/>-----<br/><p>Von: Weiss, Jörg , Gesendet: Donnerstag, 6. April 2017 08:46</p><p>&nbsp;</p><p>Die Konfiguration ist folgende:</p><p>Client-Browser https://www.ea-mv.de:443 -&gt; verschlüsselt&nbsp;</p><p>-&gt; Apache 195.145.109.36:443 (Varnishserver ProxyPass &nbsp; &nbsp; http://127.0.0.1/ )&nbsp;</p><p>-&gt; unverschlüsselt -&gt; Varnish (127.0.0.1 ohne Verschlüsselung)</p><p>-&gt; unverschlüsselt -&gt; Apache auf 127.0.0.1: 8443 &nbsp;(Varnishserver ProxyPass &nbsp; ) weiter mit ProxyPass https://195.145.109.33/</p><p>-&gt; verschlüsselt -&gt; https://195.145.109.33 (WEM-Server)</p><p>Also Client -&gt; https -&gt;Apache -&gt; http -&gt; Varnish -&gt; http -&gt; Apache -&gt; https -&gt; Apache (WEM) -&gt; ??? -&gt; WEM</p><p>Der 400’er Fehler kommt scheinbar vom WEM-Server</p><p>Die https-Verbindung zum WEM-Server stellt der Apache auf dem Varnish-Server über den vHost her, der auf Port 8443 &nbsp;läuft (vhosts.d/localhost.conf).</p><p>Der handelt mit dem Apache auf WEM über „ProxyPass https://195.145.109.33/“ die Verschlüsselung aus. Da muss meiner Meinung nach der Fehler liegen.</p><p>Varnish hat mit der Verschlüsselung nichts zu tun. Kann er auch nicht. Das läuft alles ohne Verschlüsselung.</p><p>Warum sich Varnish nicht direkt mit WEM verbindet kann ich nicht sagen.</p><p>&nbsp;</p><p>Hier https://blog.dhampir.no/content/solution-using-proxypass-from-http-to-https-in-apache2-causes-ah02032-sni-error&nbsp;</p><p>hat jemand scheinbar das Problem gelöst. Er hat einige Direktiven für die Proxy-Engine eingefügt.</p><p>Gruß Jörg</p>